{
    "pipeline": "diffusion",
    "_comment_init": "Initialize from the baseline checkpoint created earlier",
    "init_from": "UPDATE_THIS_PATH/checkpoints/ymd_.../epoch_..._ce_....ckpt",
    "resume_training": false,

    "_comment_data": "Using the variable length dataset",
    "memmap_path": "./data/02052025121536/var_len_train_38K_1024.bin",
    "padded_dataset": true,
    "pad_masked_perc": 0.15,
    "pad_annealing_steps": 100,
    "context_length": 1024,

    "_comment_model": "Model architecture should match the loaded checkpoint",
    "n_embd": 768,
    "n_layer": 12,
    "n_head": 12,
    "attn_annealing_steps": 0,
    "mask_id": 10541,
    "eos_token_id": 50256,
    "pad_token_id": 50257,

    "_comment_train": "Fine-tuning settings",
    "n_epochs": null,
    "n_steps": 5000,
    "val_check_interval": 500,
    "val_test_perc": 0.05,

    "batch_size": 8,
    "accumulate_grad": 16,
    "grad_clip":1,

    "_comment_optim": "Optimizer and scheduler settings",
    "betas": [0.9,0.95],
    "weight_decay": 0.01,
    "max_lr": 1e-4,
    "warmup_pct": 0.1,
    "div_factor":25.0,
    "final_div_factor":1e4,

    "_comment_log_save": "Logging and saving settings for fine-tuning",
    "enable_checkpointing": true,
    "save_dir": "./checkpoints/",
    "wandb": true,
    "run_name": "diffugpt-finetune-varlen-5k",
    "project_name": "diffusion-llms",

    "_comment_gen": "Generation params (ignored by train/eval)",
    "user_prompt": "Once upon a time",
    "n_samples": 1,
    "temperature": 1.0,
    "max_new_tokens": 10,
    "top_k": null,
    "diffusion_steps": 4,
    "repetition_penalty": 1.2,
    "do_sample": false,
    "denoising_strategy": "random",

    "_comment_eval": "Parameters below added/modified for eval_eos.py after fine-tuning",
    "ckpt_path_for_eval": "UPDATE_THIS_AFTER_TRAINING/checkpoints/diffugpt-finetune-varlen-5k/ymd_.../best_model.ckpt",
    "test_data_path_for_eval": "./data/02052025121536/var_len_test_380K_1024.bin",
    "eval_batch_size": 16,
    "wandb_eval": true,
    "wandb_eval_run_name_suffix": "-eval-eos"
  }
